!*> hide me

!define consumer_key {RuzufIaOgJrVk8pSXxT2g}
!define consumer_secret {Tctcwbwfzx6yKUsYDDOFarNNPkIGF5ob9HaxgdE}

!define figaroapp (

!define token {401470133-TsI7Qb8VH2GnXmTzQT7brsQyG76oZwPPb8cO2v9g}
!define secret {0i2PJBGxTJcipfNTncPsDvWtVjFpspH9CrWgASDV6qo}

)

!define msuarz (

!define token {38981100-ICrAldNvoQyLt5YfokuQRLweWhdSgXjb8PMIPvpRz}
!define secret {R1UeohJf7zejae91DUsc7Lg0jw1BrJsrUHMk1aOTT54}

)

${figaroapp}

*!

!*> vars

!define tweet_template (!-
<div style="padding:5px;color:#$color;background-image:url('$bk_img');">
  <div style="float:right"><img src="$avatar"/></div>
  <b>$user</b>:</br>
  <p style="padding:3px;background-color:white;border:1px solid #$border_color">$text</p>
</div>
-!)

!define new_tweet_template (!-
{
  "text":"@text"
}
-!)

*!

!|scenario| twitter |
|start| oauth request |https://api.twitter.com/1|
|site|twitter|
|consumer key|${consumer_key}|
|consumer secret|${consumer_secret}|
|oauth token|${token}|
|oauth secret|${secret}|

!|scenario| load last |count| tweets from |timeline|
|get|statuses/@timeline.json?count=@count|
|$response=|body|
|start|json|$response|Tweet|

!|scenario| parse tweet |tweet|
|$text=|get|@tweet.text|
|$user=|get|@tweet.user.name|
|$avatar=|get|@tweet.user.profile_image_url|
|$bk_img=|get|@tweet.user.profile_background_image_url|
|$bk_color=|get|@tweet.user.profile_background_color|
|$color=|get|@tweet.user.profile_text_color|
|$border_color=|get|@tweet.user.profile_sidebar_border_color|

!|scenario| tweet |i|
|parse tweet|Tweet[@i]|
|check|echo|${tweet_template}||

!|scenario| say |text|
|status|@text|
|post|statuses/update.json|

!|scenario| delete |id|
|post|statuses/destroy/@id.json|

